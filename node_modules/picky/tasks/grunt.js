
/*!
 * Picky
 * @license MIT
 */

if ('grunt' !== process.title) return;

/*
 * Module dependencies
 */

var Picky = require('../index');

/*
 * Variables
 */

var Suite = Picky.Suite;

/*
 * Exports
 */

module.exports = function (grunt) {

  grunt.registerMultiTask('picky', function () {
    var done = this.async();
    var options = this.options();
    var suite = new Suite(options);

    if (this.filesSrc.length === 0) {
      // grunt.log.write('No files to check...');
      // grunt.log.ok();
      return done(true);
    }

    this.files.forEach(function(file) {
      file.src.forEach(function (f) {
        suite.addFile(f);
      });
    });

    suite.run(function (err) {
      if (err) grunt.log.error('error', err);
      done();
    });

  });

}
